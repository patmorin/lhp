
To make this run in O(n log n) time we need to use lists that support O(1) time splicing.
